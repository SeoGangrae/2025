import streamlit as st
import random
import datetime

st.set_page_config(page_title="오늘의 무드 플레이리스트", page_icon="🎬", layout="centered")

# --- 장르별/기분별 작품 목록 ---
movies = {
    "액션": {"신남": ["어벤져스: 엔드게임", "미션 임파서블: 폴아웃", "분노의 질주"],
            "설렘": ["킹스맨", "존 윅"],
            "유쾌함": ["범죄도시", "베테랑"],
            "감성": ["신세계", "매드맥스: 분노의 도로"],
            "긴장": ["다크 나이트", "로건"],
            "공포": ["블레이드 러너 2049"],
            "우울": ["남한산성"]},
    "코미디": {"신남": ["극한직업", "맨 인 블랙", "행오버"],
             "설렘": ["쥬만지", "수상한 그녀"],
             "유쾌함": ["7번방의 선물", "국제시장"],
             "감성": ["웰컴 투 동막골"],
             "긴장": ["맨 인 블랙"],
             "공포": ["쥬만지"],
             "우울": ["써니", "헬로우 고스트"]},
    "드라마": {"신남": ["포레스트 검프", "굿 윌 헌팅"],
             "설렘": ["라라랜드", "인생은 아름다워"],
             "유쾌함": ["기생충"],
             "감성": ["인터스텔라", "우리들의 블루스(드라마)", "응답하라 1988(드라마)"],
             "긴장": ["레버넌트"],
             "공포": ["레버넌트"],
             "우울": ["죽은 시인의 사회", "쇼생크 탈출", "미나리"]},
    "로맨스": {"신남": ["타이타닉", "노트북"],
             "설렘": ["어바웃 타임", "비포 선라이즈"],
             "유쾌함": ["500일의 썸머", "건축학개론"],
             "감성": ["지금, 만나러 갑니다", "너의 결혼식"],
             "긴장": ["이터널 선샤인"],
             "공포": ["브로크백 마운틴"],
             "우울": ["결혼 이야기", "헤어질 결심", "시월애"]},
    "SF/판타지": {"신남": ["스타워즈: 깨어난 포스", "가디언즈 오브 갤럭시"],
               "설렘": ["닥터 스트레인지", "아바타"],
               "유쾌함": ["승리호", "듄"],
               "감성": ["블레이드 러너 2049", "엑스 마키나"],
               "긴장": ["인터스텔라"],
               "공포": ["엑스 마키나"],
               "우울": ["그래비티", "컨택트", "설국열차"]},
    "공포/스릴러": {"신남": ["겟 아웃"],
                 "설렘": ["컨저링"],
                 "유쾌함": ["곡성"],
                 "감성": ["부산행"],
                 "긴장": ["그것", "미드소마", "스플릿"],
                 "공포": ["인시디어스", "컨저링"],
                 "우울": ["살인의 추억", "조커"]}
}

# --- 작품별 명대사 & 3줄 요약 ---
# --- 작품별 명대사(한글) & 3줄 요약 ---
movie_info = {
    "미션 임파서블: 폴아웃": {
        "quote": "당신의 임무, 받아들이겠습니까…",
        "syn": [
            "이단 헌트와 IMF 팀이 세계적 위협을 막기 위해 나선다.",
            "거대한 폭발과 스릴 넘치는 스턴트 장면이 이어진다.",
            "팀워크와 개인의 희생이 중요한 메시지를 전달한다."
        ]
    },
    "킹스맨": {
        "quote": "예의가 사람을 만든다.",
        "syn": [
            "비밀 스파이 조직 킹스맨의 신입이 훈련을 받는다.",
            "훈련과 실전 임무를 통해 성장해가는 주인공.",
            "화려한 액션과 유머가 조화된 스파이 영화."
        ]
    },
    "범죄도시": {
        "quote": "법 없이도 살 수 있는 방법이 있어?",
        "syn": [
            "강력계 형사 마석도와 범죄 조직 간의 대결.",
            "조직 내 폭력과 권력 다툼을 사실적으로 그린다.",
            "액션과 긴장감이 넘치는 범죄 영화."
        ]
    },
    "신세계": {
        "quote": "누가 진짜인지 알 수 없는 세상.",
        "syn": [
            "경찰과 범죄 조직 내부의 스파이 활동을 다룬다.",
            "주인공의 정체와 충성심이 시험에 들게 된다.",
            "배신과 권력 싸움 속 인간 심리를 탐구한다."
        ]
    },
    "다크 나이트": {
        "quote": "왜 그렇게 심각해?",
        "syn": [
            "배트맨과 조커 간의 대결을 그린 슈퍼히어로 영화.",
            "도시를 혼란에 빠뜨리는 조커의 계획과 대응.",
            "선과 악, 정의와 혼돈의 경계에 대한 질문을 던진다."
        ]
    },
    "블레이드 러너 2049": {
        "quote": "당신이 믿을 수 없는 것들을 봤다.",
        "syn": [
            "복제인간과 인간의 경계가 모호한 미래 세계를 그린다.",
            "K 형사가 잃어버린 과거와 진실을 찾아 나선다.",
            "시각적 아름다움과 철학적 질문이 돋보이는 SF."
        ]
    },
    "남한산성": {
        "quote": "백성들의 삶보다 왕의 안위가 먼저인가?",
        "syn": [
            "병자호란 당시 조선의 위기 상황을 다룬 역사 영화.",
            "왕과 신하들의 선택과 백성의 고통을 보여준다.",
            "권력과 인간성, 생존에 대한 깊은 고민을 담았다."
        ]
    },
    "극한직업": {
        "quote": "치킨은 사랑입니다.",
        "syn": [
            "마약반 형사들이 잠복 중 치킨집을 운영하게 된다.",
            "의도치 않은 치킨집 성공으로 벌어지는 코미디.",
            "유쾌하고 웃긴 상황들이 계속 이어진다."
        ]
    },
    "쥬만지": {
        "quote": "게임이 시작되면 끝까지 해야 해.",
        "syn": [
            "신비한 보드게임이 현실 세계를 혼란에 빠뜨린다.",
            "아이들과 성인이 게임 속 캐릭터로 변신.",
            "유머와 모험이 가득한 가족 영화."
        ]
    },
    "7번방의 선물": {
        "quote": "사랑은 모든 것을 이긴다.",
        "syn": [
            "지적 장애를 가진 아빠가 딸과 함께 살아가는 이야기.",
            "감옥에서 다른 수감자들과 우정을 쌓는다.",
            "웃음과 눈물이 공존하는 따뜻한 가족 드라마."
        ]
    },
    "웰컴 투 동막골": {
        "quote": "전쟁보다 평화가 먼저다.",
        "syn": [
            "한국전쟁 배경, 남북 군인들이 한 마을에서 만남.",
            "문화 충돌과 우정, 사랑이 교차하는 이야기.",
            "휴머니즘과 감동을 담은 전쟁 드라마."
        ]
    },
    "맨 인 블랙": {
        "quote": "우리는 우주의 쓰레기로부터 세상을 지킨다.",
        "syn": [
            "비밀 조직 MIB가 외계인으로부터 지구를 보호한다.",
            "새로운 요원이 조직에 합류해 훈련받는다.",
            "유머와 액션이 조화된 SF 코미디 영화."
        ]
    },
    "써니": {
        "quote": "친구는 평생의 보물이다.",
        "syn": [
            "여고생 시절의 추억과 현재의 우정을 교차하며 그린다.",
            "주인공이 옛 친구들을 다시 만나게 된다.",
            "웃음과 감동이 함께하는 청춘 드라마."
        ]
    },
    "포레스트 검프": {
        "quote": "인생은 초콜릿 상자와 같아서, 뭘 얻을지 모른다.",
        "syn": [
            "순수한 마음을 가진 포레스트의 인생 여정을 그린다.",
            "미국 현대사의 주요 사건들을 포레스트의 시선으로 보여줌.",
            "사랑과 우정, 꿈과 도전의 메시지를 전달한다."
        ]
    },
    "라라랜드": {
        "quote": "꿈꾸는 바보들에게 건배.",
        "syn": [
            "재즈 피아니스트와 배우 지망생의 사랑 이야기.",
            "꿈을 향한 도전과 현실의 벽을 그린다.",
            "낭만적 뮤지컬과 감성적인 영상미가 돋보인다."
        ]
    },
    "기생충": {
        "quote": "부자는 순진하다.",
        "syn": [
            "가난한 가족과 부유한 가족의 충돌을 그린 블랙코미디.",
            "계급 차이와 인간 본성에 대한 통찰 제공.",
            "웃음과 공포가 섞인 독특한 사회 풍자 영화."
        ]
    },
    "인터스텔라": {
        "quote": "사랑은 시간과 공간을 초월한다.",
        "syn": [
            "지구의 생존 위기 속 우주 탐사를 그린 SF 영화.",
            "부성애와 과학, 인간의 도전정신을 담았다.",
            "감동적이고 철학적인 메시지가 중심."
        ]
    },
    "레버넌트": {
        "quote": "숨 쉴 수 있는 한, 싸워야 한다.",
        "syn": [
            "사냥 중 배신당한 주인공의 복수 여정.",
            "혹독한 자연 속에서 생존과 복수를 그린다.",
            "인간의 강인함과 복수심을 생생히 묘사."
        ]
    },
    "죽은 시인의 사회": {
        "quote": "오늘을 붙잡아라, 얘들아.",
        "syn": [
            "진보적 교사가 학생들에게 삶의 의미를 가르친다.",
            "학생들이 자신의 꿈과 자유를 추구하게 된다.",
            "청춘과 성장, 도전 정신을 강조하는 명작."
        ]
    },
    "타이타닉": {
        "quote": "나는 세상의 왕이다!",
        "syn": [
            "운명적 사랑과 역사적 비극을 다룬 로맨스 영화.",
            "계급 차이를 넘어선 사랑 이야기.",
            "대규모 재난과 감정을 생생히 그린다."
        ]
    },
    "노트북": {
        "quote": "네가 새라면, 나도 새야.",
        "syn": [
            "한 남녀의 깊은 사랑과 기억을 다룬 이야기.",
            "젊은 시절의 사랑과 노년의 회상을 보여줌.",
            "감성적 로맨스와 인간 관계 중심의 서사."
        ]
    },
    "어바웃 타임": {
        "quote": "우리는 모두 인생을 반복하며 산다.",
        "syn": [
            "시간 여행을 통해 사랑과 인생을 배우는 이야기.",
            "작은 선택과 행복의 중요성을 보여준다.",
            "유쾌하면서도 감동적인 로맨틱 코미디."
        ]
    },
    "500일의 썸머": {
        "quote": "이건 사랑 이야기 아니다.",
        "syn": [
            "남녀의 관계와 사랑에 대한 현실적 이야기.",
            "사랑의 시작과 끝, 기억과 감정을 다룸.",
            "유머와 현실감이 섞인 로맨틱 드라마."
        ]
    },
    "지금, 만나러 갑니다": {
        "quote": "당신과 함께하기 위해 돌아왔다.",
        "syn": [
            "사랑하는 사람과 다시 만나는 기적적 이야기.",
            "감성적인 스토리와 가족애 중심의 서사.",
            "슬프면서도 따뜻한 로맨스 영화."
        ]
    },
    "이터널 선샤인": {
        "quote": "몬토크에서 만나자.",
        "syn": [
            "사랑을 잊는 기억 삭제 과정을 다룬 영화.",
            "기억과 감정, 후회와 사랑의 의미를 탐구.",
            "독창적인 연출과 철학적 메시지가 특징."
        ]
    },
    "브로크백 마운틴": {
        "quote": "당신과 헤어질 줄 알았더라면.",
        "syn": [
            "두 남자의 금기된 사랑과 삶의 비극을 그린다.",
            "사랑과 사회적 제약, 인간 관계를 탐구.",
            "감정적이고 강렬한 드라마 영화."
        ]
    },
    "헤어질 결심": {
        "quote": "사랑은 끝나도 남는다.",
        "syn": [
            "사건 조사 중 복잡한 감정을 느끼는 형사 이야기.",
            "사랑과 의무, 인간 심리의 섬세한 묘사.",
            "미스터리와 로맨스가 결합된 드라마."
        ]
    },
    "스타워즈: 깨어난 포스": {
        "quote": "포스가 항상 함께할 것이다.",
        "syn": [
            "새로운 영웅들이 은하 제국에 맞선다.",
            "과거 영웅들과 새로운 인물들의 만남.",
            "액션과 모험, 전통적인 스타워즈 세계관 유지."
        ]
    },
    "아바타": {
        "quote": "나는 너를 본다.",
        "syn": [
            "판도라 행성을 배경으로 인간과 원주민의 갈등.",
            "환경 보호와 사랑, 전투를 담은 SF 로맨스.",
            "시각적 특수 효과와 몰입감이 뛰어나다."
        ]
    },
    "승리호": {
        "quote": "우주는 마지막 프론티어지만, 우리는 집을 만든다.",
        "syn": [
            "우주 청소선을 타고 보물을 찾는 모험 이야기.",
            "팀워크와 개인 성장, 유머가 결합된 SF 코미디.",
            "한국형 우주 영화로 특색 있는 연출 제공."
        ]
    },
    "엑스 마키나": {
        "quote": "당신을 미워하는 것을 만드는 게 이상하지 않은가?",
        "syn": [
            "인공지능 로봇과 인간의 심리적 대결을 다룸.",
            "윤리적, 철학적 질문을 탐구하는 SF 스릴러.",
            "긴장감과 반전이 돋보이는 영화."
        ]
    },
    "설국열차": {
        "quote": "모두가 평등할 수는 없다.",
        "syn": [
            "빙하기 이후 마지막 인류가 탄 열차 안 이야기.",
            "계급 투쟁과 인간 본성을 탐구.",
            "액션과 사회적 메시지가 결합된 SF 영화."
        ]
    },
    "겟 아웃": {
        "quote": "나가!",
        "syn": [
            "흑인 남성이 백인 가족 집을 방문하면서 벌어지는 공포.",
            "인종차별과 사회적 편견을 서스펜스와 결합.",
            "심리적 긴장과 반전이 중심인 공포 영화."
        ]
    },
    "컨저링": {
        "quote": "인형과 놀면 죽는다.",
        "syn": [
            "귀신 들린 집에서 초자연적 사건 조사.",
            "실화 기반으로 공포와 긴장감 조성.",
            "유령과 악령을 다룬 클래식 호러."
        ]
    },
    "곡성": {
        "quote": "악은 우리 곁에 있다.",
        "syn": [
            "작은 마을에서 일어나는 연쇄 사건과 미스터리.",
            "경찰과 주민 간의 갈등과 혼란.",
            "한국적 공포와 스릴러가 혼합된 영화."
        ]
    },
    "부산행": {
        "quote": "살고 싶다면 뛰어야 한다.",
        "syn": [
            "좀비 바이러스가 퍼진 상황에서 살아남기 위한 여정.",
            "부산으로 향하는 기차 안의 긴장감.",
            "액션과 감동, 인간 관계 중심의 스릴러."
        ]
    },
    "그것": {
        "quote": "너도 뜬다!",
        "syn": [
            "어린 시절의 트라우마와 공포를 마주하는 이야기.",
            "악마적 존재와의 대결을 그린 공포 영화.",
            "긴장과 공포, 성장 서사를 결합."
        ]
    },
    "인시디어스": {
        "quote": "멀리 갈수록 가까워진다.",
        "syn": [
            "가족이 초자연적 세계에 휘말리는 이야기.",
            "영혼과 악령의 세계를 탐험.",
            "공포와 미스터리 요소가 결합된 영화."
        ]
    },
    "조커": {
        "quote": "나만 그런가, 세상이 점점 미쳐가는 것 같지 않아?",
        "syn": [
            "사회와 개인의 소외가 악의 탄생을 그린다.",
            "코미디언의 비극적 변화를 집중 조명.",
            "정신적 불안과 사회적 메시지를 전달."
        ]
    }
}

# --- 기분별 배경 색상 (파스텔 톤) ---
mood_bg = {
    "신남": "#FFF9A5",      # 연노랑
    "설렘": "#FFB6C1",      # 연핑크
    "유쾌함": "#FFD8A8",    # 연주황
    "감성": "#ADD8E6",      # 연파랑
    "긴장": "#CDA4E8",      # 연보라
    "공포": "#F08080",      # 연붉은
    "우울": "#D3D3D3"       # 연회색
}

st.title("오늘의 무드 플레이리스트")

# --- 입력 UI ---
col1, col2 = st.columns(2)
with col1:
    genre = st.selectbox("🎬 장르", list(movies.keys()))
with col2:
    mood = st.selectbox("😊 현재 기분", list(mood_bg.keys()))


# 추천 로직
if st.button("추천받기"):
    candidates = movies.get(genre, {}).get(mood, [])
    
    if not candidates:
        st.warning("선택하신 조합은 아직 준비 중이에요! 다른 기분을 선택해 보세요.")
    else:
        pool = [m for m in candidates if m in movie_info] or candidates
        title = random.choice(pool)

        st.write(f"🎬 추천 영화: **{title}**")


        # 배경색 적용
        st.markdown(
            f"""
            <style>
            .stApp {{
                background-color: {mood_bg.get(mood, "#FFFFFF")};
                transition: background-color 0.6s ease;
            }}
            .big-title {{
                font-size: 2.5em !important;
                font-weight: bold;
            }}
            .quote {{
                font-size: 1.5em !important;
                color: #333333;
            }}
            .synopsis {{
                font-size: 1.2em !important;
            }}
            </style>
            """, unsafe_allow_html=True
        )

        st.markdown(f"<div class='big-title'>오늘의 추천 작품: {title}</div>", unsafe_allow_html=True)

        if title in movie_info:
            st.markdown(f"<div class='quote'>🎞️ 명대사: {movie_info[title]['quote']}</div>", unsafe_allow_html=True)
            st.markdown("<div class='synopsis'>📘 3줄 요약</div>", unsafe_allow_html=True)
            for line in movie_info[title]["syn"]:
                st.markdown(f"<div class='synopsis'>- {line}</div>", unsafe_allow_html=True)
        else:
            st.info("해당 작품의 명대사/요약은 준비 중이에요!")

# --- 오늘의 추천 (날짜 고정) ---
all_titles = [title for g in movies.values() for lst in g.values() for title in lst]
today = datetime.date.today()
random.seed(today.toordinal())
daily_pick = random.choice(all_titles)

st.divider()
st.caption(f"📅 오늘({today})의 고정 추천")
st.write(f"🎬 **{daily_pick}**")

if daily_pick in movie_info:
    st.caption("한 줄 대사")
    st.write(f"“{movie_info[daily_pick]['quote']}”")
    st.caption("3줄 요약")
    for line in movie_info[daily_pick]["syn"]:
        st.write(f"- {line}")
